<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–í—à–∞–Ω—É–≤–∞–Ω–Ω—è –ì–µ—Ä–æ—ó–≤ –£–∫—Ä–∞—ó–Ω–∏</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <header>
    <h1>üíî –í—ñ—á–Ω–∞ –ø–∞–º º—è—Ç—å –ì–µ—Ä–æ—è–º –£–∫—Ä–∞—ó–Ω–∏ üíî</h1>
  </header>
  <div class="counter">
    üëÅ –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤ —Å—å–æ–≥–æ–¥–Ω—ñ: <span id="visitor-count">0</span><br>
    ‚úÖ –ó–∞–≥–∞–ª—å–Ω—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∑–∞ –ø–µ—Ç–∏—Ü—ñ—è–º–∏: <span id="total-clicks">0</span>
  </div>
  <div class="petition-list" id="petition-list"></div>
  <script>
    const petitions = [
      { id: "kinash", name: "–†–æ–º–∞–Ω –ö—ñ–Ω–∞—à üî•üî•üî•", url: "https://petition.president.gov.ua/petition/245246" },
      { id: "lystopad", name: "–ê–Ω—Ç–æ–Ω –õ–∏—Å—Ç–æ–ø–∞–¥", url: "https://petition.president.gov.ua/petition/245654" },
      { id: "klekach", name: "–í–∞—Å–∏–ª—å –ö–ª–µ–∫–∞—á", url: "https://petition.president.gov.ua/petition/244660" },
      { id: "hned", name: "–û–ª–µ–≥ –ì–Ω–µ–¥", url: "https://petition.president.gov.ua/petition/244852" },
      { id: "buzykov", name: "–Æ—Ä—ñ–π –ë—É–∑—ñ–∫–æ–≤ üî•üî•üî•", url: "https://petition.president.gov.ua/petition/244036" },
      { id: "tanasyuk", name: "–ë–æ–≥–¥–∞–Ω –¢–∞–Ω–∞—Å—é–∫ üî•üî•üî•", url: "https://petition.president.gov.ua/petition/243292" },
      { id: "valko", name: "–†—É—Å–ª–∞–Ω –í–∞–ª—å–∫–æ üî•üî•üî•", url: "https://petition.president.gov.ua/petition/244108" },
      { id: "chmut", name: "–Æ—Ä—ñ–π –ß–º—É—Ç üî•üî•üî•", url: "https://petition.president.gov.ua/petition/243630" }
    ];

    fetch("/track", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ type: "visit" })
    });

    fetch("/stats")
      .then(res => res.json())
      .then(data => {
        document.getElementById("visitor-count").textContent = data.visits;
        let total = 0;
        petitions.forEach(p => {
          const count = data.clicks[p.id] || 0;
          total += count;
          const div = document.createElement("div");
          div.className = "petition";
          div.innerHTML = \`
            <div><strong>\${p.name}</strong></div>
            <a href="\${p.url}" target="_blank" onclick="trackClick('\${p.id}')">\${p.url}</a>
            <div class="clicks">–ü–µ—Ä–µ—Ö–æ–¥—ñ–≤ —Å—å–æ–≥–æ–¥–Ω—ñ: <span id="click-\${p.id}">\${count}</span></div>
          \`;
          document.getElementById("petition-list").appendChild(div);
        });
        document.getElementById("total-clicks").textContent = total;
      });

    function trackClick(id) {
      fetch("/track", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id })
      }).then(() => {
        const el = document.getElementById("click-" + id);
        el.textContent = parseInt(el.textContent) + 1;
        const total = document.getElementById("total-clicks");
        total.textContent = parseInt(total.textContent) + 1;
      });
    }
  </script>
</body>
</html>